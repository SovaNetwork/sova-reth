use std::{collections::BTreeMap, str::FromStr};

use alloy_primitives::{address, keccak256, Address, B256, U256};
use reth_chainspec::{ChainHardforks, EthereumHardfork, ForkCondition, Hardfork};
use reth_optimism_forks::OpHardfork;

pub const SOVA_ADDR_CONVERT_DOMAIN_TAG: &[u8] = b"sova:evm2btc:v1.0";

pub fn sova_forks() -> ChainHardforks {
    ChainHardforks::new(vec![
        (EthereumHardfork::Frontier.boxed(), ForkCondition::Block(0)),
        (EthereumHardfork::Homestead.boxed(), ForkCondition::Block(0)),
        (EthereumHardfork::Dao.boxed(), ForkCondition::Block(0)),
        (EthereumHardfork::Tangerine.boxed(), ForkCondition::Block(0)),
        (
            EthereumHardfork::SpuriousDragon.boxed(),
            ForkCondition::Block(0),
        ),
        (EthereumHardfork::Byzantium.boxed(), ForkCondition::Block(0)),
        (
            EthereumHardfork::Constantinople.boxed(),
            ForkCondition::Block(0),
        ),
        (
            EthereumHardfork::Petersburg.boxed(),
            ForkCondition::Block(0),
        ),
        (EthereumHardfork::Istanbul.boxed(), ForkCondition::Block(0)),
        (EthereumHardfork::Berlin.boxed(), ForkCondition::Block(0)),
        (EthereumHardfork::London.boxed(), ForkCondition::Block(0)),
        (
            EthereumHardfork::Paris.boxed(),
            ForkCondition::TTD {
                fork_block: None,
                total_difficulty: U256::ZERO,
                activation_block_number: 0,
            },
        ),
        (OpHardfork::Bedrock.boxed(), ForkCondition::Block(0)),
        (OpHardfork::Regolith.boxed(), ForkCondition::Timestamp(0)),
        (
            EthereumHardfork::Shanghai.boxed(),
            ForkCondition::Timestamp(0),
        ),
        (OpHardfork::Canyon.boxed(), ForkCondition::Timestamp(0)),
        (
            EthereumHardfork::Cancun.boxed(),
            ForkCondition::Timestamp(0),
        ),
        (OpHardfork::Ecotone.boxed(), ForkCondition::Timestamp(0)),
        (OpHardfork::Fjord.boxed(), ForkCondition::Timestamp(0)),
        (OpHardfork::Granite.boxed(), ForkCondition::Timestamp(0)),
        // NOTE(powvt): The following forks cannot be activated in DEV mode due to not being able to
        // add eip1559 params to genesis config. All OP genesis:configs:{} need to have this:
        // "optimism": {
        //     "eip1559Elasticity": 6,
        //     "eip1559Denominator": 50,
        //     "eip1559DenominatorCanyon": 250
        // }
        //
        // (OpHardfork::Holocene.boxed(), ForkCondition::Timestamp(0)),
        // (
        //     EthereumHardfork::Prague.boxed(),
        //     ForkCondition::Timestamp(0),
        // ),
        // (OpHardfork::Isthmus.boxed(), ForkCondition::Timestamp(0)),
    ])
}

pub const BROADCAST_TRANSACTION_PRECOMPILE_ID: u64 = 0x999;
pub const DECODE_TRANSACTION_PRECOMPILE_ID: u64 = 0x998;
pub const CONVERT_ADDRESS_PRECOMPILE_ID: u64 = 0x997;

/// Represents all available Bitcoin precompile methods with their associated gas parameter
#[derive(Debug, Clone, Copy, Eq, Hash, PartialEq)]
pub enum BitcoinPrecompileMethod {
    /// Broadcasts a Bitcoin transaction
    BroadcastTransaction,
    /// Decodes a raw Bitcoin transaction
    DecodeTransaction,
    /// Converts EVM address to Bitcoin address
    ConvertAddress,
}

pub const BROADCAST_TRANSACTION_ADDRESS: Address =
    address!("0000000000000000000000000000000000000999");
pub const DECODE_TRANSACTION_ADDRESS: Address =
    address!("0000000000000000000000000000000000000998");
pub const CONVERT_ADDRESS_ADDRESS: Address = address!("0000000000000000000000000000000000000997");

pub const BITCOIN_PRECOMPILE_ADDRESSES: [Address; 3] = [
    BROADCAST_TRANSACTION_ADDRESS,
    DECODE_TRANSACTION_ADDRESS,
    CONVERT_ADDRESS_ADDRESS,
];

// Sova L1Block contract address
pub const SOVA_L1_BLOCK_CONTRACT_ADDRESS: Address =
    address!("0x2100000000000000000000000000000000000015");
// SovaL1Block contract properties
pub const L1_BLOCK_CURRENT_BLOCK_HEIGHT_SLOT: U256 = U256::ZERO;

// SovaL1Block contract bytecode
// NOTE(powvt): you must use `forge inspect src/SovaL1Block.sol:SovaL1Block deployedBytecode` copying from artifacts will not work
// NOTE(powvt): This bytecode coincides with commit `196646e40d6a5ebb51a5edd1bdc10b58a244ba1a` of the SovaNetwork/contracts
pub const L1_BLOCK_CONTRACT_CODE: &str = "0x6080604052600436106100865760003560e01c80638da5cb5b116100595780638da5cb5b146100d4578063cb0d2046146100ff578063f04e283e14610128578063f2fde38b14610144578063fee81cf41461016057610086565b8063256929621461008b57806354d1f13d1461009557806354fd4d501461009f578063715018a6146100ca575b600080fd5b61009361019d565b005b61009d6101f1565b005b3480156100ab57600080fd5b506100b461022d565b6040516100c19190610585565b60405180910390f35b6100d261026a565b005b3480156100e057600080fd5b506100e961027e565b6040516100f691906105e8565b60405180910390f35b34801561010b57600080fd5b506101266004803603810190610121919061067e565b6102a7565b005b610142600480360381019061013d91906106ea565b610356565b005b61015e600480360381019061015991906106ea565b610397565b005b34801561016c57600080fd5b50610187600480360381019061018291906106ea565b6103c1565b6040516101949190610730565b60405180910390f35b60006101a76103dc565b67ffffffffffffffff164201905063389a75e1600c5233600052806020600c2055337fdbf36a107da19e49527a7176a1babf963b4b0ff8cde35ee35d6cd8f1f9ac7e1d600080a250565b63389a75e1600c523360005260006020600c2055337ffa7b8eab7da67f412cc9575ed43464468f9bfbae89d1675917346ca6d8fe3c92600080a2565b60606040518060400160405280600c81526020017f302e312e302d626574612e320000000000000000000000000000000000000000815250905090565b6102726103e7565b61027c600061041f565b565b60007fffffffffffffffffffffffffffffffffffffffffffffffffffffffff7487392754905090565b6102af61027e565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461031c576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610313906107bd565b60405180910390fd5b816000806101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555080600181905550436002819055505050565b61035e6103e7565b63389a75e1600c52806000526020600c20805442111561038657636f5e88186000526004601cfd5b60008155506103948161041f565b50565b61039f6103e7565b8060601b6103b557637448fbae6000526004601cfd5b6103be8161041f565b50565b600063389a75e1600c52816000526020600c20549050919050565b60006202a300905090565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffff7487392754331461041d576382b429006000526004601cfd5b565b6104276104e7565b1561048d577fffffffffffffffffffffffffffffffffffffffffffffffffffffffff748739278160601b60601c91508181547f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0600080a3811560ff1b82178155506104e4565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffff748739278160601b60601c91508181547f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0600080a3818155505b50565b600090565b600081519050919050565b600082825260208201905092915050565b60005b8381101561052657808201518184015260208101905061050b565b83811115610535576000848401525b50505050565b6000601f19601f8301169050919050565b6000610557826104ec565b61056181856104f7565b9350610571818560208601610508565b61057a8161053b565b840191505092915050565b6000602082019050818103600083015261059f818461054c565b905092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006105d2826105a7565b9050919050565b6105e2816105c7565b82525050565b60006020820190506105fd60008301846105d9565b92915050565b600080fd5b600067ffffffffffffffff82169050919050565b61062581610608565b811461063057600080fd5b50565b6000813590506106428161061c565b92915050565b6000819050919050565b61065b81610648565b811461066657600080fd5b50565b60008135905061067881610652565b92915050565b6000806040838503121561069557610694610603565b5b60006106a385828601610633565b92505060206106b485828601610669565b9150509250929050565b6106c7816105c7565b81146106d257600080fd5b50565b6000813590506106e4816106be565b92915050565b600060208284031215610700576106ff610603565b5b600061070e848285016106d5565b91505092915050565b6000819050919050565b61072a81610717565b82525050565b60006020820190506107456000830184610721565b92915050565b7f536f76614c31426c6f636b3a206f6e6c792074686520636861696e2061646d6960008201527f6e2063616e2073657420626c6f636b2064617461000000000000000000000000602082015250565b60006107a76034836104f7565b91506107b28261074b565b604082019050919050565b600060208201905081810360008301526107d68161079a565b905091905056fea26469706673582212204b27a24d8733e9a56c1c8d30cac06d5b7b1a04c9610deb450dd09d229923469764736f6c634300080f0033";

pub fn sova_l1_block_contract_storage() -> BTreeMap<B256, B256> {
    let mut sova_btc_storage = BTreeMap::new();

    // Set the owner - the _OWNER_SLOT from the solady::Ownable contract
    sova_btc_storage.insert(
        B256::from_str("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffff74873927")
            .unwrap(),
        // Owner address padded to 32 bytes
        B256::from_str("0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266")
            .unwrap(),
    );

    sova_btc_storage
}

// SovaBTC contract address
pub const SOVA_BTC_CONTRACT_ADDRESS: Address =
    address!("0x2100000000000000000000000000000000000020");

// SovaBTC contract bytecode
// NOTE(powvt): you must use `forge inspect src/SovaBTC.sol:SovaBTC deployedBytecode` copying from artifacts will not work
// NOTE(powvt): This bytecode coincides with commit `196646e40d6a5ebb51a5edd1bdc10b58a244ba1a` of the SovaNetwork/contracts
pub const SOVA_BTC_CONTRACT_CODE: &str = "0x6080604052600436106102465760003560e01c8063715018a611610139578063b187bd26116100b6578063d792dfed1161007a578063d792dfed1461088d578063dd62ed3e146108ca578063e11ba34e14610907578063f04e283e14610930578063f2fde38b1461094c578063fee81cf41461096857610246565b8063b187bd2614610796578063b5408709146107c1578063c49bbfd0146107fe578063ce6a705214610827578063d505accf1461086457610246565b806395d89b41116100fd57806395d89b411461068b57806399f47d49146106b65780639a04f65d146106f35780639c96f62614610730578063a9059cbb1461075957610246565b8063715018a6146105d957806379c86cab146105e35780637ecebe001461060c5780638456cb59146106495780638da5cb5b1461066057610246565b8063304b5ca5116101c757806354d1f13d1161018b57806354d1f13d146104ed578063620b9228146104f7578063645006ca1461053457806370a082311461055f57806370b92c9f1461059c57610246565b8063304b5ca51461042e578063313ce567146104575780633644e515146104825780633f4ba83a146104ad5780634ef39b75146104c457610246565b8063215f2ecb1161020e578063215f2ecb1461034457806323b872dd1461036d57806324e71639146103aa57806325692962146103e75780632d0a0b7c146103f157610246565b8063065ed1ba1461024b57806306dd04191461028857806306fdde03146102b1578063095ea7b3146102dc57806318160ddd14610319575b600080fd5b34801561025757600080fd5b50610272600480360381019061026d9190612e3c565b6109a5565b60405161027f9190612e82565b60405180910390f35b34801561029457600080fd5b506102af60048036038101906102aa9190612ec9565b6109f1565b005b3480156102bd57600080fd5b506102c6610a07565b6040516102d39190612fa2565b60405180910390f35b3480156102e857600080fd5b5061030360048036038101906102fe9190612ec9565b610a44565b6040516103109190612fdf565b60405180910390f35b34801561032557600080fd5b5061032e610ad4565b60405161033b9190612e82565b60405180910390f35b34801561035057600080fd5b5061036b60048036038101906103669190612e3c565b610ae6565b005b34801561037957600080fd5b50610394600480360381019061038f9190612ffa565b610c10565b6040516103a19190612fdf565b60405180910390f35b3480156103b657600080fd5b506103d160048036038101906103cc9190612e3c565b610c31565b6040516103de9190613070565b60405180910390f35b6103ef610c91565b005b3480156103fd57600080fd5b50610418600480360381019061041391906130c1565b610ce5565b6040516104259190612fdf565b60405180910390f35b34801561043a57600080fd5b5061045560048036038101906104509190612e3c565b610d0f565b005b34801561046357600080fd5b5061046c610e38565b604051610479919061310a565b60405180910390f35b34801561048e57600080fd5b50610497610e41565b6040516104a49190613134565b60405180910390f35b3480156104b957600080fd5b506104c2610ec0565b005b3480156104d057600080fd5b506104eb60048036038101906104e69190612e3c565b610f30565b005b6104f5610f3c565b005b34801561050357600080fd5b5061051e60048036038101906105199190612e3c565b610f78565b60405161052b9190612fa2565b60405180910390f35b34801561054057600080fd5b5061054961104c565b6040516105569190613070565b60405180910390f35b34801561056b57600080fd5b5061058660048036038101906105819190612e3c565b611066565b6040516105939190612e82565b60405180910390f35b3480156105a857600080fd5b506105c360048036038101906105be9190612e3c565b611081565b6040516105d09190612e82565b60405180910390f35b6105e16110cc565b005b3480156105ef57600080fd5b5061060a600480360381019061060591906131e0565b6110e0565b005b34801561061857600080fd5b50610633600480360381019061062e9190612e3c565b611432565b6040516106409190612e82565b60405180910390f35b34801561065557600080fd5b5061065e61144d565b005b34801561066c57600080fd5b506106756114bd565b6040516106829190613277565b60405180910390f35b34801561069757600080fd5b506106a06114e6565b6040516106ad9190612fa2565b60405180910390f35b3480156106c257600080fd5b506106dd60048036038101906106d89190612e3c565b611523565b6040516106ea9190612e82565b60405180910390f35b3480156106ff57600080fd5b5061071a60048036038101906107159190612e3c565b61156f565b6040516107279190613070565b60405180910390f35b34801561073c57600080fd5b5061075760048036038101906107529190613314565b6115cf565b005b34801561076557600080fd5b50610780600480360381019061077b9190612ec9565b61187e565b60405161078d9190612fdf565b60405180910390f35b3480156107a257600080fd5b506107ab61189d565b6040516107b89190612fdf565b60405180910390f35b3480156107cd57600080fd5b506107e860048036038101906107e39190612e3c565b6118b4565b6040516107f59190612e82565b60405180910390f35b34801561080a57600080fd5b5061082560048036038101906108209190613388565b6118ff565b005b34801561083357600080fd5b5061084e60048036038101906108499190612e3c565b611988565b60405161085b9190612fdf565b60405180910390f35b34801561087057600080fd5b5061088b600480360381019061088691906133b5565b6119a8565b005b34801561089957600080fd5b506108b460048036038101906108af9190612e3c565b611b75565b6040516108c19190612e82565b60405180910390f35b3480156108d657600080fd5b506108f160048036038101906108ec9190613457565b611bc1565b6040516108fe9190612e82565b60405180910390f35b34801561091357600080fd5b5061092e60048036038101906109299190613497565b611c5a565b005b61094a60048036038101906109459190612e3c565b611ee3565b005b61096660048036038101906109619190612e3c565b611f24565b005b34801561097457600080fd5b5061098f600480360381019061098a9190612e3c565b611f4e565b60405161099c9190612e82565b60405180910390f35b6000600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001549050919050565b6109f9611f69565b610a038282611fa1565b5050565b60606040518060400160405280601481526020017f536f7661205772617070656420426974636f696e000000000000000000000000815250905090565b6000610a4e612038565b15610a82578119156e22d473030f116ddee9f6b43ac78ba38460601b60601c1817610a8157633f68539a6000526004601cfd5b5b82602052637f5e9f20600c5233600052816034600c205581600052602c5160601c337f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560206000a36001905092915050565b60006805345cdf77eb68f44c54905090565b610aee611f69565b600560008273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615610b72576040517f38615ecc00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6001600560008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055508073ffffffffffffffffffffffffffffffffffffffff167f1173339a258bc3211be882000b271c0bfc3c8f03539a1886a240ee6143352d7f60405160405180910390a250565b600083610c1c8161203d565b610c27858585612109565b9150509392505050565b6000600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900467ffffffffffffffff169050919050565b6000610c9b6122b6565b67ffffffffffffffff164201905063389a75e1600c5233600052806020600c2055337fdbf36a107da19e49527a7176a1babf963b4b0ff8cde35ee35d6cd8f1f9ac7e1d600080a250565b60006004600083815260200190815260200160002060009054906101000a900460ff169050919050565b610d17611f69565b600560008273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16610d9a576040517fd244b30700000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6000600560008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055508073ffffffffffffffffffffffffffffffffffffffff167f403723b025aba3e49bd382e2738cd29f60237e1f0ab65b0b16437e59ba37046260405160405180910390a250565b60006008905090565b600080610e4c6122c1565b90506000801b8103610e6a57610e60610a07565b8051906020012090505b6000610e746122c6565b90506040517f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f815282602082015281604082015246606082015230608082015260a08120935050505090565b610ec8611f69565b610ed06122f1565b6000600360086101000a81548160ff0219169083151502179055503373ffffffffffffffffffffffffffffffffffffffff167f1e23e4fdb1bf02ae807015930fac26dcb02b50d8835da28b756e7848be48054d60405160405180910390a2565b610f3981612339565b50565b63389a75e1600c523360005260006020600c2055337ffa7b8eab7da67f412cc9575ed43464468f9bfbae89d1675917346ca6d8fe3c92600080a2565b6060600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206002018054610fc790613560565b80601f0160208091040260200160405190810160405280929190818152602001828054610ff390613560565b80156110405780601f1061101557610100808354040283529160200191611040565b820191906000526020600020905b81548152906001019060200180831161102357829003601f168201915b50505050509050919050565b600360009054906101000a900467ffffffffffffffff1681565b60006387a211a2600c52816000526020600c20549050919050565b60008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001549050919050565b6110d4611f69565b6110de6000612519565b565b6110e86125e1565b60008282905003611125576040517f7a1bc98400000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b60008567ffffffffffffffff1603611169576040517f1f2a200500000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b60008467ffffffffffffffff16036111ad576040517f3e267f9500000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b60008385876111bc91906135c0565b6111c691906135c0565b67ffffffffffffffff169050806111dc33611066565b1015611214576040517f5945ea5600000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6000600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001541115611291576040517f75c4147300000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b60405180608001604052808767ffffffffffffffff1681526020018667ffffffffffffffff1681526020018567ffffffffffffffff16815260200184848080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050815250600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000820151816000015560208201518160010160006101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555060408201518160010160086101000a81548167ffffffffffffffff021916908367ffffffffffffffff16021790555060608201518160020190816113d091906137d9565b509050503373ffffffffffffffffffffffffffffffffffffffff167f7ad0ff25ff4aea7141cf3484afa82e0ef21fc210030ff1fb0c76579613e3e0598787878787604051611422959493929190613918565b60405180910390a2505050505050565b60006338377508600c52816000526020600c20549050919050565b611455611f69565b61145d6125e1565b6001600360086101000a81548160ff0219169083151502179055503373ffffffffffffffffffffffffffffffffffffffff167fae07ae543c78e8fc8929e0e4ef3f294b3e7e68e469bc3c6948487fd5d168645f60405160405180910390a2565b60007fffffffffffffffffffffffffffffffffffffffffffffffffffffffff7487392754905090565b60606040518060400160405280600781526020017f736f766142544300000000000000000000000000000000000000000000000000815250905090565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600101549050919050565b6000600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160089054906101000a900467ffffffffffffffff169050919050565b3068929eee149b4bd2126854036115ee5763ab143c066000526004601cfd5b3068929eee149b4bd21268556116026125e1565b600360009054906101000a900467ffffffffffffffff1667ffffffffffffffff168467ffffffffffffffff161015611666576040517fc24b1b6100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b60006116c184848080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050508667ffffffffffffffff168461262a565b9050600460008260000151815260200190815260200160002060009054906101000a900460ff161561171f576040517f830b785a00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000154111561179b576040517fe782da8f00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6001600460008360000151815260200190815260200160002060006101000a81548160ff0219169083151502179055506117df338667ffffffffffffffff16612822565b61182c84848080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050612890565b7f19dacbf83c5de6658e14cbf7bcae5c15eca2eedecf1c66fbca928e4d351bea0f3382600001518760405161186393929190613966565b60405180910390a1503868929eee149b4bd212685550505050565b60003361188a8161203d565b6118948484612959565b91505092915050565b6000600360089054906101000a900460ff16905090565b60008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600101549050919050565b611907611f69565b6000600360009054906101000a900467ffffffffffffffff16905081600360006101000a81548167ffffffffffffffff021916908367ffffffffffffffff1602179055507fe4f71d3bf64b70199599598aa763257d0089b33b9c512e4c30363c1d776f3a0e818360405161197c92919061399d565b60405180910390a15050565b60056020528060005260406000206000915054906101000a900460ff1681565b6119b0612038565b156119e4578419156e22d473030f116ddee9f6b43ac78ba38760601b60601c18176119e357633f68539a6000526004601cfd5b5b60006119ee6122c1565b90506000801b8103611a0c57611a02610a07565b8051906020012090505b6000611a166122c6565b905085421115611a2e57631a15a3cc6000526004601cfd5b6040518960601b60601c99508860601b60601c985065383775081901600e52896000526020600c2080547f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f835284602084015283604084015246606084015230608084015260a08320602e527f6e71edae12b1b97f4d1f60370fef10105fa2faae0126114a169c64845d6126c983528b60208401528a60408401528960608401528060808401528860a084015260c08320604e526042602c206000528760ff1660205286604052856060526020806080600060015afa8c3d5114611b1a5763ddafbaef6000526004601cfd5b80820183558b637f5e9f2060a01b176040528a6034602c20558b8d7f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925602060608801a383604052600060605250505050505050505050505050565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001549050919050565b6000611bcb612038565b15611c3b576e22d473030f116ddee9f6b43ac78ba373ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603611c3a577fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff9050611c54565b5b81602052637f5e9f20600c52826000526034600c205490505b92915050565b611c626125e1565b611c6a6129eb565b6000600160008873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001541115611ce7576040517f75c4147300000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6000611d3686868080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050612a70565b905060008267ffffffffffffffff168467ffffffffffffffff168667ffffffffffffffff16611d6591906139c6565b611d6f91906139c6565b905080611d7b89611066565b1015611db3576040517f5945ea5600000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b611dbd8882612b5a565b600260008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000808201600090556001820160006101000a81549067ffffffffffffffff02191690556001820160086101000a81549067ffffffffffffffff0219169055600282016000611e4b9190612d42565b5050611e9a87878080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050612890565b7fc3ded2be7db21b1af963f267d27750e4a15f174547d88b886b9bda43e2c6fa3288836000015183604051611ed193929190613a1c565b60405180910390a15050505050505050565b611eeb611f69565b63389a75e1600c52806000526020600c208054421115611f1357636f5e88186000526004601cfd5b6000815550611f2181612519565b50565b611f2c611f69565b8060601b611f4257637448fbae6000526004601cfd5b611f4b81612519565b50565b600063389a75e1600c52816000526020600c20549050919050565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffff74873927543314611f9f576382b429006000526004601cfd5b565b611fad82600083612bc9565b6387a211a2600c52816000526020600c20805480831115611fd65763f4d678b86000526004601cfd5b8281038255826805345cdf77eb68f44c54036805345cdf77eb68f44c558260005260008460601b60601c7fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60206000a3505061203482600083612bce565b5050565b600090565b60008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000015411806120cf57506000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060000154115b15612106576040517fa0b2d7b100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b50565b6000612116848484612bc9565b61211e612038565b156121ef578360601b6e22d473030f116ddee9f6b43ac78ba333146121785733602052637f5e9f208117600c526034600c208054801915612175578085111561216f576313be252b6000526004601cfd5b84810382555b50505b6387a211a28117600c526020600c2080548085111561219f5763f4d678b86000526004601cfd5b8481038255856000526020600c2085815401815585602052600c5160601c8460601c7fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef602080a3505050506122a0565b8360601b33602052637f5e9f208117600c526034600c20805480191561222b5780851115612225576313be252b6000526004601cfd5b84810382555b6387a211a28317600c526020600c208054808711156122525763f4d678b86000526004601cfd5b8681038255876000526020600c2087815401815587602052600c5160601c8660601c7fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef602080a35050505050505b6122ab848484612bce565b600190509392505050565b60006202a300905090565b600090565b60007fc89efdaa54c0f20c7adf612882df0950f5a951637e0307cdcb4c672f298b8bc660001b905090565b600360089054906101000a900460ff16612337576040517fdcdde9dd00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b565b60008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000015411156124265760008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000015490506000808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600080820160009055600182016000905550506124248282612bd3565b505b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001541115612516576000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001549050600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600080820160009055600182016000905550506125148282611fa1565b505b50565b612521612c6a565b15612587577fffffffffffffffffffffffffffffffffffffffffffffffffffffffff748739278160601b60601c91508181547f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0600080a3811560ff1b82178155506125de565b7fffffffffffffffffffffffffffffffffffffffffffffffffffffffff748739278160601b60601c91508181547f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0600080a3818155505b50565b600360089054906101000a900460ff1615612628576040517fab35696f00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b565b612632612d82565b600061263d85612a70565b90506001816020015151108061265857506003816020015151115b1561268f576040517fb2e532de00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b8381602001518460ff16815181106126aa576126a9613a53565b5b602002602001015160200151146126ed576040517f2c5211c600000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6001816040015151101561272d576040517ff8b3bb6100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b600081606001511461276b576040517f0620e0ae00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b600061277633612c6f565b905081602001518460ff168151811061279257612791613a53565b5b602002602001015160000151805190602001208180519060200120146128165781602001518460ff16815181106127cc576127cb613a53565b5b602002602001015160000151816040517f665e974900000000000000000000000000000000000000000000000000000000815260040161280d929190613a82565b60405180910390fd5b81925050509392505050565b6040518060400160405280828152602001428152506000808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000155602082015181600101559050505050565b600061099973ffffffffffffffffffffffffffffffffffffffff16826040516020016128bc9190613b00565b6040516020818303038152906040526040516128d89190613b00565b6000604051808303816000865af19150503d8060008114612915576040519150601f19603f3d011682016040523d82523d6000602084013e61291a565b606091505b5050905080612955576040517ffd23ff6400000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5050565b6000612966338484612bc9565b6387a211a2600c52336000526020600c2080548084111561298f5763f4d678b86000526004601cfd5b8381038255846000526020600c2084815401815584602052600c5160601c337fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef602080a35050506129e1338484612bce565b6001905092915050565b600560003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16612a6e576040517fdca1a0ce00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b565b612a78612d82565b60008061099873ffffffffffffffffffffffffffffffffffffffff1684604051602001612aa59190613b00565b604051602081830303815290604052604051612ac19190613b00565b600060405180830381855afa9150503d8060008114612afc576040519150601f19603f3d011682016040523d82523d6000602084013e612b01565b606091505b509150915081612b3d576040517ffd23ff6400000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b80806020019051810190612b5191906141b9565b92505050919050565b604051806040016040528082815260200142815250600160008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000155602082015181600101559050505050565b505050565b505050565b612bdf60008383612bc9565b6805345cdf77eb68f44c5481810181811015612c035763e5cfe9576000526004601cfd5b806805345cdf77eb68f44c556387a211a2600c52836000526020600c2083815401815583602052600c5160601c60007fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef602080a3505050612c6660008383612bce565b5050565b600090565b606060008061099773ffffffffffffffffffffffffffffffffffffffff1684604051602001612c9e919061424a565b604051602081830303815290604052604051612cba9190613b00565b6000604051808303816000865af19150503d8060008114612cf7576040519150601f19603f3d011682016040523d82523d6000602084013e612cfc565b606091505b509150915081612d38576040517ffd23ff6400000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b8092505050919050565b508054612d4e90613560565b6000825580601f10612d605750612d7f565b601f016020900490600052602060002090810190612d7e9190612dad565b5b50565b6040518060800160405280600080191681526020016060815260200160608152602001600081525090565b5b80821115612dc6576000816000905550600101612dae565b5090565b6000604051905090565b600080fd5b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000612e0982612dde565b9050919050565b612e1981612dfe565b8114612e2457600080fd5b50565b600081359050612e3681612e10565b92915050565b600060208284031215612e5257612e51612dd4565b5b6000612e6084828501612e27565b91505092915050565b6000819050919050565b612e7c81612e69565b82525050565b6000602082019050612e976000830184612e73565b92915050565b612ea681612e69565b8114612eb157600080fd5b50565b600081359050612ec381612e9d565b92915050565b60008060408385031215612ee057612edf612dd4565b5b6000612eee85828601612e27565b9250506020612eff85828601612eb4565b9150509250929050565b600081519050919050565b600082825260208201905092915050565b60005b83811015612f43578082015181840152602081019050612f28565b83811115612f52576000848401525b50505050565b6000601f19601f8301169050919050565b6000612f7482612f09565b612f7e8185612f14565b9350612f8e818560208601612f25565b612f9781612f58565b840191505092915050565b60006020820190508181036000830152612fbc8184612f69565b905092915050565b60008115159050919050565b612fd981612fc4565b82525050565b6000602082019050612ff46000830184612fd0565b92915050565b60008060006060848603121561301357613012612dd4565b5b600061302186828701612e27565b935050602061303286828701612e27565b925050604061304386828701612eb4565b9150509250925092565b600067ffffffffffffffff82169050919050565b61306a8161304d565b82525050565b60006020820190506130856000830184613061565b92915050565b6000819050919050565b61309e8161308b565b81146130a957600080fd5b50565b6000813590506130bb81613095565b92915050565b6000602082840312156130d7576130d6612dd4565b5b60006130e5848285016130ac565b91505092915050565b600060ff82169050919050565b613104816130ee565b82525050565b600060208201905061311f60008301846130fb565b92915050565b61312e8161308b565b82525050565b60006020820190506131496000830184613125565b92915050565b6131588161304d565b811461316357600080fd5b50565b6000813590506131758161314f565b92915050565b600080fd5b600080fd5b600080fd5b60008083601f8401126131a05761319f61317b565b5b8235905067ffffffffffffffff8111156131bd576131bc613180565b5b6020830191508360018202830111156131d9576131d8613185565b5b9250929050565b6000806000806000608086880312156131fc576131fb612dd4565b5b600061320a88828901613166565b955050602061321b88828901613166565b945050604061322c88828901613166565b935050606086013567ffffffffffffffff81111561324d5761324c612dd9565b5b6132598882890161318a565b92509250509295509295909350565b61327181612dfe565b82525050565b600060208201905061328c6000830184613268565b92915050565b60008083601f8401126132a8576132a761317b565b5b8235905067ffffffffffffffff8111156132c5576132c4613180565b5b6020830191508360018202830111156132e1576132e0613185565b5b9250929050565b6132f1816130ee565b81146132fc57600080fd5b50565b60008135905061330e816132e8565b92915050565b6000806000806060858703121561332e5761332d612dd4565b5b600061333c87828801613166565b945050602085013567ffffffffffffffff81111561335d5761335c612dd9565b5b61336987828801613292565b9350935050604061337c878288016132ff565b91505092959194509250565b60006020828403121561339e5761339d612dd4565b5b60006133ac84828501613166565b91505092915050565b600080600080600080600060e0888a0312156133d4576133d3612dd4565b5b60006133e28a828b01612e27565b97505060206133f38a828b01612e27565b96505060406134048a828b01612eb4565b95505060606134158a828b01612eb4565b94505060806134268a828b016132ff565b93505060a06134378a828b016130ac565b92505060c06134488a828b016130ac565b91505092959891949750929550565b6000806040838503121561346e5761346d612dd4565b5b600061347c85828601612e27565b925050602061348d85828601612e27565b9150509250929050565b60008060008060008060a087890312156134b4576134b3612dd4565b5b60006134c289828a01612e27565b965050602087013567ffffffffffffffff8111156134e3576134e2612dd9565b5b6134ef89828a01613292565b9550955050604061350289828a01613166565b935050606061351389828a01613166565b925050608061352489828a01613166565b9150509295509295509295565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b6000600282049050600182168061357857607f821691505b60208210810361358b5761358a613531565b5b50919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b60006135cb8261304d565b91506135d68361304d565b92508267ffffffffffffffff038211156135f3576135f2613591565b5b828201905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b60006008830261368f7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82613652565b6136998683613652565b95508019841693508086168417925050509392505050565b6000819050919050565b60006136d66136d16136cc84612e69565b6136b1565b612e69565b9050919050565b6000819050919050565b6136f0836136bb565b6137046136fc826136dd565b84845461365f565b825550505050565b600090565b61371961370c565b6137248184846136e7565b505050565b5b818110156137485761373d600082613711565b60018101905061372a565b5050565b601f82111561378d5761375e8161362d565b61376784613642565b81016020851015613776578190505b61378a61378285613642565b830182613729565b50505b505050565b600082821c905092915050565b60006137b060001984600802613792565b1980831691505092915050565b60006137c9838361379f565b9150826002028217905092915050565b6137e282612f09565b67ffffffffffffffff8111156137fb576137fa6135fe565b5b6138058254613560565b61381082828561374c565b600060209050601f8311600181146138435760008415613831578287015190505b61383b85826137bd565b8655506138a3565b601f1984166138518661362d565b60005b8281101561387957848901518255600182019150602085019450602081019050613854565b868310156138965784890151613892601f89168261379f565b8355505b6001600288020188555050505b505050505050565b60006138c66138c16138bc8461304d565b6136b1565b612e69565b9050919050565b6138d6816138ab565b82525050565b82818337600083830152505050565b60006138f78385612f14565b93506139048385846138dc565b61390d83612f58565b840190509392505050565b600060808201905061392d60008301886138cd565b61393a6020830187613061565b6139476040830186613061565b818103606083015261395a8184866138eb565b90509695505050505050565b600060608201905061397b6000830186613268565b6139886020830185613125565b61399560408301846138cd565b949350505050565b60006040820190506139b26000830185613061565b6139bf6020830184613061565b9392505050565b60006139d182612e69565b91506139dc83612e69565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff03821115613a1157613a10613591565b5b828201905092915050565b6000606082019050613a316000830186613268565b613a3e6020830185613125565b613a4b6040830184612e73565b949350505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b60006040820190508181036000830152613a9c8185612f69565b90508181036020830152613ab08184612f69565b90509392505050565b600081519050919050565b600081905092915050565b6000613ada82613ab9565b613ae48185613ac4565b9350613af4818560208601612f25565b80840191505092915050565b6000613b0c8284613acf565b915081905092915050565b600080fd5b613b2582612f58565b810181811067ffffffffffffffff82111715613b4457613b436135fe565b5b80604052505050565b6000613b57612dca565b9050613b638282613b1c565b919050565b600080fd5b600081519050613b7c81613095565b92915050565b600067ffffffffffffffff821115613b9d57613b9c6135fe565b5b602082029050602081019050919050565b600080fd5b600067ffffffffffffffff821115613bce57613bcd6135fe565b5b613bd782612f58565b9050602081019050919050565b6000613bf7613bf284613bb3565b613b4d565b905082815260208101848484011115613c1357613c12613bae565b5b613c1e848285612f25565b509392505050565b600082601f830112613c3b57613c3a61317b565b5b8151613c4b848260208601613be4565b91505092915050565b600081519050613c6381612e9d565b92915050565b600067ffffffffffffffff821115613c8457613c836135fe565b5b613c8d82612f58565b9050602081019050919050565b6000613cad613ca884613c69565b613b4d565b905082815260208101848484011115613cc957613cc8613bae565b5b613cd4848285612f25565b509392505050565b600082601f830112613cf157613cf061317b565b5b8151613d01848260208601613c9a565b91505092915050565b600060608284031215613d2057613d1f613b17565b5b613d2a6060613b4d565b9050600082015167ffffffffffffffff811115613d4a57613d49613b68565b5b613d5684828501613c26565b6000830152506020613d6a84828501613c54565b602083015250604082015167ffffffffffffffff811115613d8e57613d8d613b68565b5b613d9a84828501613cdc565b60408301525092915050565b6000613db9613db484613b82565b613b4d565b90508083825260208201905060208402830185811115613ddc57613ddb613185565b5b835b81811015613e2357805167ffffffffffffffff811115613e0157613e0061317b565b5b808601613e0e8982613d0a565b85526020850194505050602081019050613dde565b5050509392505050565b600082601f830112613e4257613e4161317b565b5b8151613e52848260208601613da6565b91505092915050565b600067ffffffffffffffff821115613e7657613e756135fe565b5b602082029050602081019050919050565b600063ffffffff82169050919050565b613ea081613e87565b8114613eab57600080fd5b50565b600081519050613ebd81613e97565b92915050565b600067ffffffffffffffff821115613ede57613edd6135fe565b5b602082029050602081019050919050565b6000613f02613efd84613ec3565b613b4d565b90508083825260208201905060208402830185811115613f2557613f24613185565b5b835b81811015613f6c57805167ffffffffffffffff811115613f4a57613f4961317b565b5b808601613f578982613cdc565b85526020850194505050602081019050613f27565b5050509392505050565b600082601f830112613f8b57613f8a61317b565b5b8151613f9b848260208601613eef565b91505092915050565b600060808284031215613fba57613fb9613b17565b5b613fc46080613b4d565b90506000613fd484828501613b6d565b6000830152506020613fe884828501613eae565b602083015250604082015167ffffffffffffffff81111561400c5761400b613b68565b5b61401884828501613cdc565b604083015250606082015167ffffffffffffffff81111561403c5761403b613b68565b5b61404884828501613f76565b60608301525092915050565b600061406761406284613e5b565b613b4d565b9050808382526020820190506020840283018581111561408a57614089613185565b5b835b818110156140d157805167ffffffffffffffff8111156140af576140ae61317b565b5b8086016140bc8982613fa4565b8552602085019450505060208101905061408c565b5050509392505050565b600082601f8301126140f0576140ef61317b565b5b8151614100848260208601614054565b91505092915050565b60006080828403121561411f5761411e613b17565b5b6141296080613b4d565b9050600061413984828501613b6d565b600083015250602082015167ffffffffffffffff81111561415d5761415c613b68565b5b61416984828501613e2d565b602083015250604082015167ffffffffffffffff81111561418d5761418c613b68565b5b614199848285016140db565b60408301525060606141ad84828501613c54565b60608301525092915050565b6000602082840312156141cf576141ce612dd4565b5b600082015167ffffffffffffffff8111156141ed576141ec612dd9565b5b6141f984828501614109565b91505092915050565b60008160601b9050919050565b600061421a82614202565b9050919050565b600061422c8261420f565b9050919050565b61424461423f82612dfe565b614221565b82525050565b60006142568284614233565b6014820191508190509291505056fea2646970667358221220ac70842042b8451807ead846ee57a0039dcad0268207aca76f52400ac15f938b64736f6c634300080f0033";

// ╭------------------------------+-------------------------------------------------------+------+--------+-------+-------------------------╮
// | Name                         | Type                                                  | Slot | Offset | Bytes | Contract                |
// +========================================================================================================================================+
// | _pendingDeposits             | mapping(address => struct UBTC20.Pending)             | 0    | 0      | 32    | src/SovaBTC.sol:SovaBTC |
// |------------------------------+-------------------------------------------------------+------+--------+-------+-------------------------|
// | _pendingWithdrawals          | mapping(address => struct UBTC20.Pending)             | 1    | 0      | 32    | src/SovaBTC.sol:SovaBTC |
// |------------------------------+-------------------------------------------------------+------+--------+-------+-------------------------|
// | _pendingUserWithdrawRequests | mapping(address => struct UBTC20.UserWithdrawRequest) | 2    | 0      | 32    | src/SovaBTC.sol:SovaBTC |
// |------------------------------+-------------------------------------------------------+------+--------+-------+-------------------------|
// | minDepositAmount             | uint64                                                | 3    | 0      | 8     | src/SovaBTC.sol:SovaBTC |
// |------------------------------+-------------------------------------------------------+------+--------+-------+-------------------------|
// | _paused                      | bool                                                  | 3    | 8      | 1     | src/SovaBTC.sol:SovaBTC |
// |------------------------------+-------------------------------------------------------+------+--------+-------+-------------------------|
// | usedTxids                    | mapping(bytes32 => bool)                              | 4    | 0      | 32    | src/SovaBTC.sol:SovaBTC |
// |------------------------------+-------------------------------------------------------+------+--------+-------+-------------------------|
// | withdrawSigners              | mapping(address => bool)                              | 5    | 0      | 32    | src/SovaBTC.sol:SovaBTC |
// ╰------------------------------+-------------------------------------------------------+------+--------+-------+-------------------------╯

pub fn sova_btc_contract_storage() -> BTreeMap<B256, B256> {
    let mut sova_btc_storage = BTreeMap::new();

    // Set the owner - the _OWNER_SLOT from the Ownable contract
    sova_btc_storage.insert(
        B256::from_str("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffff74873927")
            .unwrap(),
        // Owner address padded to 32 bytes
        B256::from_str("0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266")
            .unwrap(),
    );

    // Set Slot 3: Pack the initialized variables
    // - minDepositAmount (8 bytes, 10,000 = 0x2710)
    // - _paused (1 byte at offset 8, false = 0x00)
    sova_btc_storage.insert(
        B256::from_str("0x0000000000000000000000000000000000000000000000000000000000000003")
            .unwrap(),
        // minDepositAmount (10,000) in the least significant 8 bytes
        B256::from_str("0x0000000000000000000000000000000000000000000000000000000000002710")
            .unwrap(),
    );

    // Set initial withdraw signer in the withdrawSigners mapping (slot 5)
    // withdrawSigners[0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266] = true
    let signer_address =
        B256::from_str("0x000000000000000000000000f39fd6e51aad88f6f4ce6ab8827279cfffb92266")
            .unwrap();

    // Slot 5 is the withdrawSigners mapping
    let slot_5 =
        B256::from_str("0x0000000000000000000000000000000000000000000000000000000000000005")
            .unwrap();

    // Calculate keccak256(address . slot) for the mapping key
    let mut data = [0u8; 64];
    data[0..32].copy_from_slice(&signer_address.0);
    data[32..64].copy_from_slice(&slot_5.0);

    let storage_slot = keccak256(data);

    sova_btc_storage.insert(
        storage_slot,
        // Value = true (1)
        B256::from_str("0x0000000000000000000000000000000000000000000000000000000000000001")
            .unwrap(),
    );

    sova_btc_storage
}
